<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: AuthController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">AuthController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/auth_controller_rb.html">
                app/controllers/auth_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000089">cancelSession</a>&nbsp;&nbsp;
      <a href="#M000083">confirm</a>&nbsp;&nbsp;
      <a href="#M000087">denied</a>&nbsp;&nbsp;
      <a href="#M000073">image</a>&nbsp;&nbsp;
      <a href="#M000072">index</a>&nbsp;&nbsp;
      <a href="#M000077">info</a>&nbsp;&nbsp;
      <a href="#M000074">jsinfo</a>&nbsp;&nbsp;
      <a href="#M000079">login</a>&nbsp;&nbsp;
      <a href="#M000082">logout</a>&nbsp;&nbsp;
      <a href="#M000084">lostpassword</a>&nbsp;&nbsp;
      <a href="#M000075">remoteinfo</a>&nbsp;&nbsp;
      <a href="#M000078">remotelogin</a>&nbsp;&nbsp;
      <a href="#M000076">resendnewemail</a>&nbsp;&nbsp;
      <a href="#M000080">resendsignup</a>&nbsp;&nbsp;
      <a href="#M000085">reset</a>&nbsp;&nbsp;
      <a href="#M000088">saveSession</a>&nbsp;&nbsp;
      <a href="#M000081">signup</a>&nbsp;&nbsp;
      <a href="#M000091">theme_layout</a>&nbsp;&nbsp;
      <a href="#M000090">this_auth</a>&nbsp;&nbsp;
      <a href="#M000086">welcome</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000083" class="method-detail">
        <a name="M000083"></a>

        <div class="method-heading">
          <a href="#M000083" class="method-signature">
          <span class="method-name">confirm</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000083-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000083-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 269</span>
269:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">confirm</span>
270:                 <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;&quot;</span>
271:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">nil?</span>
272:                         <span class="ruby-ivar">@email</span>,<span class="ruby-identifier">validkey</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>,<span class="ruby-value">2</span>)
273:                 <span class="ruby-keyword kw">end</span>
274: 
275:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>][<span class="ruby-identifier">:validkey</span>]
276:                         <span class="ruby-identifier">validkey</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>][<span class="ruby-identifier">:validkey</span>]
277:                         <span class="ruby-ivar">@email</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>][<span class="ruby-identifier">:email</span>]
278:                 <span class="ruby-keyword kw">end</span>
279: 
280:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">validkey</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@email</span>.<span class="ruby-identifier">empty?</span>
281:       <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;email = ?&quot;</span>,<span class="ruby-ivar">@email</span>])
282: 
283:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">validkey</span>
284:         <span class="ruby-comment cmt"># User is confirming his account</span>
285:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">confirmed?</span>
286:           <span class="ruby-identifier">user</span>.<span class="ruby-identifier">confirmed</span>= <span class="ruby-value">1</span>
287:           <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> = <span class="ruby-keyword kw">nil</span>
288: 
289:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">save</span>
290:             <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>] = <span class="ruby-keyword kw">nil</span>
291:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span> <span class="ruby-identifier">user</span>
292:             <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:message</span>] = <span class="ruby-value str">&quot;Your account is confirmed. Please take some time to setup your preferences.&quot;</span>
293:             <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;info&quot;</span>
294:           <span class="ruby-keyword kw">else</span>
295:             <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;An error occured while saving your account&quot;</span>
296:           <span class="ruby-keyword kw">end</span>
297:         <span class="ruby-comment cmt"># The user is asking for an email address change</span>
298:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">confirmed?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">newemail</span>.<span class="ruby-identifier">nil?</span>
299:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">email_change_isvalid?</span>(<span class="ruby-identifier">user</span>.<span class="ruby-identifier">newemail</span>, <span class="ruby-identifier">validkey</span>)
300:             <span class="ruby-identifier">user</span>.<span class="ruby-identifier">email</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">newemail</span>
301:             <span class="ruby-identifier">user</span>.<span class="ruby-identifier">newemail</span> = <span class="ruby-keyword kw">nil</span>
302:             <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> = <span class="ruby-keyword kw">nil</span>
303:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">save</span>
304:               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span>(<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">expire_at</span>)
305:               <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Your email has been changed.&quot;</span>
306:               <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;info&quot;</span>
307:             <span class="ruby-keyword kw">else</span>
308:               <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;An error occured while saving your account.&quot;</span>
309:             <span class="ruby-keyword kw">end</span>
310:           <span class="ruby-keyword kw">else</span>
311:             <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;This validation key is incorrect.&quot;</span>
312:           <span class="ruby-keyword kw">end</span>
313:         <span class="ruby-keyword kw">end</span>
314:       <span class="ruby-keyword kw">else</span>
315:         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;This validation key is incorrect. Maybe you already confirmed your account?&quot;</span>
316:       <span class="ruby-keyword kw">end</span>
317:     <span class="ruby-keyword kw">end</span>
318: 
319:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>].<span class="ruby-identifier">nil?</span>
320:                         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>]
321:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>][<span class="ruby-identifier">:email</span>]
322:                         <span class="ruby-ivar">@email</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:user</span>][<span class="ruby-identifier">:email</span>]
323:                 <span class="ruby-keyword kw">end</span>
324:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000087" class="method-detail">
        <a name="M000087"></a>

        <div class="method-heading">
          <a href="#M000087" class="method-signature">
          <span class="method-name">denied</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000087-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000087-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 418</span>
418:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">denied</span>
419:                 <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
420:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000073" class="method-detail">
        <a name="M000073"></a>

        <div class="method-heading">
          <a href="#M000073" class="method-signature">
          <span class="method-name">image</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000073-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000073-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 12</span>
12:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">image</span>
13:                 <span class="ruby-identifier">login</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>], <span class="ruby-value str">&quot;.png&quot;</span>)
14:                 <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;login = ?&quot;</span>, <span class="ruby-identifier">login</span>])
15:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>
16:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">image</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">image</span>.<span class="ruby-identifier">empty?</span>
17:                                 <span class="ruby-identifier">send_data</span>(<span class="ruby-identifier">user</span>.<span class="ruby-identifier">image</span>,
18:                                 <span class="ruby-identifier">:filename=</span><span class="ruby-operator">&gt;</span><span class="ruby-node">&quot;#{login}.png&quot;</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;image/png&quot;</span>, <span class="ruby-identifier">:disposition=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;inline&quot;</span>
19:                                 )
20:                         <span class="ruby-keyword kw">else</span>
21:                                 <span class="ruby-identifier">send_file</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/public#{@app[:default_icon]}&quot;</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;image/png&quot;</span>, <span class="ruby-identifier">:disposition=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;inline&quot;</span>, <span class="ruby-identifier">:streaming</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:stream</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
22:                         <span class="ruby-keyword kw">end</span>
23:                 <span class="ruby-keyword kw">end</span>
24:                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
25:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000072" class="method-detail">
        <a name="M000072"></a>

        <div class="method-heading">
          <a href="#M000072" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000072-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000072-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 4</span>
 4:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
 5:                 <span class="ruby-identifier">del_location</span>
 6:                 <span class="ruby-ivar">@title</span> = <span class="ruby-value str">&quot;User Interface&quot;</span>
 7:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">ident</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
 8:                         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;login&quot;</span>
 9:                 <span class="ruby-keyword kw">end</span>
10:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000077" class="method-detail">
        <a name="M000077"></a>

        <div class="method-heading">
          <a href="#M000077" class="method-signature">
          <span class="method-name">info</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000077-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000077-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 49</span>
 49:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info</span>
 50:                 <span class="ruby-identifier">require_auth</span>
 51: 
 52:                 <span class="ruby-ivar">@title</span> = <span class="ruby-value str">&quot;Your preferences&quot;</span>
 53:                 <span class="ruby-ivar">@newuser</span> = <span class="ruby-keyword kw">nil</span>
 54: 
 55:                 <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">reload</span>
 56: 
 57:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span>
 58:                         <span class="ruby-ivar">@newuser</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;login = ? AND confirmed=1&quot;</span>, <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">login</span>])
 59:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">lastname</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:lastname</span>]
 60:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">firstname</span>= <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:firstname</span>]
 61:                         <span class="ruby-identifier">notice</span> = <span class="ruby-value str">&quot;&quot;</span>
 62:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>].<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:passwordbis</span>].<span class="ruby-identifier">empty?</span>
 63:                            <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:passwordbis</span>]
 64:                                    <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">password</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>]
 65:                            <span class="ruby-keyword kw">else</span>
 66:                               <span class="ruby-identifier">notice</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;Your password don't match!&quot;</span>
 67:                            <span class="ruby-keyword kw">end</span>
 68:                         <span class="ruby-keyword kw">end</span>
 69:                         
 70:                         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">and</span>
 71:                                 <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>].<span class="ruby-identifier">original_filename</span>.<span class="ruby-identifier">empty?</span>
 72:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>].<span class="ruby-identifier">content_type</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^image/</span>
 73:                                         <span class="ruby-identifier">notice</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;Your picture isn't an image !&quot;</span> 
 74:                                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
 75:                                 <span class="ruby-keyword kw">else</span>
 76: 
 77:                                         <span class="ruby-identifier">tempfile</span> = <span class="ruby-constant">Tempfile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'tmp'</span>)
 78:                                         <span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">write</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>].<span class="ruby-identifier">read</span>
 79:                                         <span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">flush</span>
 80:                                         <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span>(<span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">path</span>, <span class="ruby-identifier">mode</span>=<span class="ruby-value str">&quot;r&quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
 81:                                                 <span class="ruby-identifier">img</span> = <span class="ruby-keyword kw">nil</span>
 82:                                                 <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:picture</span>].<span class="ruby-identifier">content_type</span>.<span class="ruby-identifier">chomp</span>
 83:                                                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;image/jpeg&quot;</span> <span class="ruby-keyword kw">then</span>
 84:                                                         <span class="ruby-identifier">img</span> = <span class="ruby-constant">GD</span><span class="ruby-operator">::</span><span class="ruby-constant">Image</span>.<span class="ruby-identifier">newFromJpeg</span>(<span class="ruby-identifier">f</span>)
 85:                                                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;image/png&quot;</span> <span class="ruby-keyword kw">then</span>
 86:                                                         <span class="ruby-identifier">img</span> = <span class="ruby-constant">GD</span><span class="ruby-operator">::</span><span class="ruby-constant">Image</span>.<span class="ruby-identifier">newFromPng</span>(<span class="ruby-identifier">f</span>)
 87:                                                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;image/pjpeg&quot;</span> <span class="ruby-keyword kw">then</span>
 88:                                                         <span class="ruby-identifier">img</span> = <span class="ruby-constant">GD</span><span class="ruby-operator">::</span><span class="ruby-constant">Image</span>.<span class="ruby-identifier">newFromJpeg</span>(<span class="ruby-identifier">f</span>)
 89:                                                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;image/x-png&quot;</span> <span class="ruby-keyword kw">then</span>
 90:                                                         <span class="ruby-identifier">img</span> = <span class="ruby-constant">GD</span><span class="ruby-operator">::</span><span class="ruby-constant">Image</span>.<span class="ruby-identifier">newFromPng</span>(<span class="ruby-identifier">f</span>)
 91:                                                 <span class="ruby-keyword kw">end</span>
 92: 
 93:                                                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">img</span>.<span class="ruby-identifier">nil?</span>
 94:                                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">img</span>.<span class="ruby-identifier">bounds</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">img</span>.<span class="ruby-identifier">bounds</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>]
 95:                                                                 <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">image</span> = <span class="ruby-identifier">img</span>.<span class="ruby-identifier">pngStr</span>  <span class="ruby-comment cmt"># = @params[:post][:picture].read</span>
 96:                                                         <span class="ruby-keyword kw">else</span>
 97: <span class="ruby-comment cmt">#                                                               notice += &quot;Your image isn't #{@app[:icon_size]}x#{@app[:icon_size]}!&quot;</span>
 98:                 <span class="ruby-identifier">aspect_ratio</span> = <span class="ruby-identifier">img</span>.<span class="ruby-identifier">width</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">img</span>.<span class="ruby-identifier">height</span>.<span class="ruby-identifier">to_f</span>
 99:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">aspect_ratio</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1.0</span>
100:                   <span class="ruby-identifier">nHeight</span> = <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>]
101:                   <span class="ruby-identifier">nWidth</span>  = <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>] <span class="ruby-operator">*</span> <span class="ruby-identifier">aspect_ratio</span>
102:                 <span class="ruby-keyword kw">else</span>
103:                   <span class="ruby-identifier">nWidth</span>  = <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>]
104:                   <span class="ruby-identifier">nHeight</span> = <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">aspect_ratio</span>
105:                 <span class="ruby-keyword kw">end</span>                
106:                 <span class="ruby-identifier">thumb</span> = <span class="ruby-constant">GD</span><span class="ruby-operator">::</span><span class="ruby-constant">Image</span>.<span class="ruby-identifier">newTrueColor</span>(<span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>], <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:icon_size</span>])
107:                 <span class="ruby-identifier">img</span>.<span class="ruby-identifier">copyResized</span>(<span class="ruby-identifier">thumb</span>, <span class="ruby-value">0</span>,<span class="ruby-value">0</span>,<span class="ruby-value">0</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">nWidth</span>, <span class="ruby-identifier">nHeight</span>, <span class="ruby-identifier">img</span>.<span class="ruby-identifier">width</span>, <span class="ruby-identifier">img</span>.<span class="ruby-identifier">height</span>)
108:                 <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">image</span> = <span class="ruby-identifier">thumb</span>.<span class="ruby-identifier">pngStr</span> <span class="ruby-comment cmt"># = @params[:post][:picture].read</span>
109:                 <span class="ruby-identifier">thumb</span>.<span class="ruby-identifier">destroy</span>
110:                                                         <span class="ruby-keyword kw">end</span>
111:                                                         <span class="ruby-identifier">img</span>.<span class="ruby-identifier">destroy</span>
112:                                                 <span class="ruby-keyword kw">end</span>
113:                                         }
114:                                 <span class="ruby-keyword kw">end</span>
115:                                 <span class="ruby-identifier">expire_page</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'image'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{@newuser.login}.png&quot;</span>
116:                         <span class="ruby-keyword kw">end</span>
117:                         
118:                         <span class="ruby-identifier">sentemail</span> = <span class="ruby-keyword kw">false</span>
119:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:newemail</span>].<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:newemail</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span>
120:         <span class="ruby-identifier">tmpuser</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;email = ?&quot;</span>,<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:newemail</span>]])
121:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmpuser</span>.<span class="ruby-identifier">nil?</span>
122:           <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">newemail</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:newemail</span>]
123:                                         <span class="ruby-identifier">sentemail</span> = <span class="ruby-keyword kw">true</span>
124:           <span class="ruby-comment cmt"># @newuser.generate_validkey_email(@newuser.newemail)</span>
125:           <span class="ruby-comment cmt"># </span>
126:           <span class="ruby-comment cmt">#           Notification.deliver_emailchange(@newuser, @app)</span>
127:         <span class="ruby-keyword kw">else</span>
128:           <span class="ruby-identifier">notice</span> = <span class="ruby-value str">&quot;An account already uses this email address.&quot;</span>
129:         <span class="ruby-keyword kw">end</span>
130:                         <span class="ruby-keyword kw">end</span>
131: 
132:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">notice</span>.<span class="ruby-identifier">empty?</span>
133:                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-identifier">notice</span>
134:                         <span class="ruby-keyword kw">else</span>
135:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">save</span>
136:                                         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-value str">&quot;Your preferences have been saved.\n&quot;</span>
137: 
138:                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sentemail</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>
139:                                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-value str">&quot;We sent you a message, please check your mails.&quot;</span>
140:                                         <span class="ruby-keyword kw">end</span>
141: 
142:                                         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span>(<span class="ruby-ivar">@newuser</span>, <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">expire_at</span>)
143:                                         <span class="ruby-ivar">@user</span> = <span class="ruby-ivar">@newuser</span>
144:                                         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">reload</span>
145:                                 <span class="ruby-keyword kw">else</span>
146:                                         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'warning'</span>] = <span class="ruby-value str">&quot;An error occured while saving your preferences&quot;</span>
147:                                 <span class="ruby-keyword kw">end</span>
148:                         <span class="ruby-keyword kw">end</span>
149:                 <span class="ruby-keyword kw">end</span>
150:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000074" class="method-detail">
        <a name="M000074"></a>

        <div class="method-heading">
          <a href="#M000074" class="method-signature">
          <span class="method-name">jsinfo</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the account information through a javascript call
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000074-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000074-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 28</span>
28:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">jsinfo</span>
29:                 <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">false</span>
30:                 <span class="ruby-ivar">@headers</span>[<span class="ruby-value str">&quot;Content-Type&quot;</span>] = <span class="ruby-value str">&quot;text/plain&quot;</span> 
31:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000079" class="method-detail">
        <a name="M000079"></a>

        <div class="method-heading">
          <a href="#M000079" class="method-signature">
          <span class="method-name">login</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000079-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000079-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 173</span>
173:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">login</span>
174:                 <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">method</span>
175:                 <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:post</span>
176:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>].<span class="ruby-identifier">nil?</span>
177:                                 <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">authenticate</span>(<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:login</span>], <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>])
178:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>
179:                                         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span>(<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:keepalive</span>].<span class="ruby-identifier">to_i</span>)
180:                                         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Login successful.&quot;</span>
181:                                         <span class="ruby-identifier">redirect_back_or_default</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;manage&quot;</span>
182:                                 <span class="ruby-keyword kw">else</span>
183:                                         <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;Oops, unknown username or password. &quot;</span> \
184:                                         <span class="ruby-value str">&quot;Have you signed up yet?&quot;</span> <span class="ruby-value str">&quot; If you've forgotten your password, we can email it to you.&quot;</span>
185:                                         <span class="ruby-ivar">@login</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:login</span>]
186:                                         <span class="ruby-ivar">@err</span> = <span class="ruby-value">2</span>;
187:                                 <span class="ruby-keyword kw">end</span>
188:                         <span class="ruby-keyword kw">end</span>
189:                 <span class="ruby-keyword kw">end</span>
190:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000082" class="method-detail">
        <a name="M000082"></a>

        <div class="method-heading">
          <a href="#M000082" class="method-signature">
          <span class="method-name">logout</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000082-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000082-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">logout</span>
256:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@user</span>
257:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>
258:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
259:                 <span class="ruby-keyword kw">end</span>
260: 
261:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">xhr?</span>
262:                         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span> <span class="ruby-comment cmt">#, :text =&gt; &quot;Thanks for your visit.&quot;</span>
263:                 <span class="ruby-keyword kw">end</span>
264:                 <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cancelSession</span>()
265:                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'message'</span>] = <span class="ruby-value str">&quot;Thanks for your visit.&quot;</span>
266:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;welcome&quot;</span>
267:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000084" class="method-detail">
        <a name="M000084"></a>

        <div class="method-heading">
          <a href="#M000084" class="method-signature">
          <span class="method-name">lostpassword</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000084-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000084-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 326</span>
326:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lostpassword</span>
327:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">ident</span>
328:                         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">generate_validkey</span>
329:                         <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">save</span>
330: 
331:                         <span class="ruby-constant">Notification</span>.<span class="ruby-identifier">deliver_forgot</span>(<span class="ruby-ivar">@user</span>, <span class="ruby-ivar">@app</span>)
332:                         <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'notice'</span>]  = <span class="ruby-value str">&quot;We sent you a message, please check your mails.&quot;</span>
333:                         <span class="ruby-identifier">redirect_back_or_default</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>
334:                 <span class="ruby-keyword kw">end</span>
335: 
336:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:email</span>]
337:                         <span class="ruby-ivar">@newuser</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;email = ?&quot;</span>,<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:email</span>]])
338:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">nil?</span>
339:                                 <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">generate_validkey</span>
340:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">save</span>
341:                                         <span class="ruby-constant">Notification</span>.<span class="ruby-identifier">deliver_forgot</span>(<span class="ruby-ivar">@newuser</span>, <span class="ruby-ivar">@app</span>)
342:                                         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]  = <span class="ruby-value str">&quot;We sent you a message, please check your mails.&quot;</span>
343:                                         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;login&quot;</span> 
344:                                 <span class="ruby-keyword kw">else</span>    
345:                                         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]  = <span class="ruby-value str">&quot;An error occured while saving informations.&quot;</span>
346:                                         <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span> <span class="ruby-value str">&quot;An error occured while saving user informations.&quot;</span>
347:                                 <span class="ruby-keyword kw">end</span>     
348:                         <span class="ruby-keyword kw">else</span>    
349:                                 <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Couldn't find an account with this email address.&quot;</span>
350:                         <span class="ruby-keyword kw">end</span>     
351:                 <span class="ruby-keyword kw">else</span>    
352:                         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>
353:                                 <span class="ruby-ivar">@email</span> = <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">email</span>
354:                         <span class="ruby-keyword kw">else</span>    
355:                                 <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;&quot;</span>
356:                         <span class="ruby-keyword kw">end</span>     
357:                 <span class="ruby-keyword kw">end</span>
358: 
359: 
360:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000075" class="method-detail">
        <a name="M000075"></a>

        <div class="method-heading">
          <a href="#M000075" class="method-signature">
          <span class="method-name">remoteinfo</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000075-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000075-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 33</span>
33:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remoteinfo</span>
34:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">xhr?</span>
35:                         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">false</span>
36:                 <span class="ruby-keyword kw">end</span>
37:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000078" class="method-detail">
        <a name="M000078"></a>

        <div class="method-heading">
          <a href="#M000078" class="method-signature">
          <span class="method-name">remotelogin</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000078-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000078-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 152</span>
152:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remotelogin</span>
153:                 <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">method</span>
154:                 <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:post</span>
155:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:login</span>].<span class="ruby-identifier">nil?</span>
156:                                 <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">authenticate</span>(<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:login</span>], <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>])
157:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>
158:                                         <span class="ruby-ivar">@err</span> = <span class="ruby-value">0</span>
159:                                         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span>(<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:keepalive</span>].<span class="ruby-identifier">to_i</span>)
160:                                         <span class="ruby-comment cmt">#render :text =&gt; &quot;Login successfull! &lt;script type=\&quot;text/javascript\&quot;&gt;setTimeout(external_load, 2000);&lt;/script&gt;&quot;, :layout =&gt; false</span>
161:                                         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
162:                                 <span class="ruby-keyword kw">else</span>
163:                                         <span class="ruby-ivar">@err</span> = <span class="ruby-value">2</span> 
164:                                         <span class="ruby-comment cmt">#render :text =&gt; &quot;Wrong login or password! &lt;script type=\&quot;text/javascript\&quot;&gt;setTimeout(external_load, 2000);&lt;/script&gt;&quot;, :layout =&gt; false</span>
165:                                         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
166:                                 <span class="ruby-keyword kw">end</span>
167:                         <span class="ruby-keyword kw">else</span>
168:                                 <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
169:                         <span class="ruby-keyword kw">end</span>
170:                 <span class="ruby-keyword kw">end</span>
171:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000076" class="method-detail">
        <a name="M000076"></a>

        <div class="method-heading">
          <a href="#M000076" class="method-signature">
          <span class="method-name">resendnewemail</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000076-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000076-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 39</span>
39:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resendnewemail</span>
40:                 <span class="ruby-identifier">require_auth</span>
41:                 <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">reload</span>
42: 
43:                 <span class="ruby-constant">Notification</span>.<span class="ruby-identifier">deliver_emailchange</span>(<span class="ruby-ivar">@user</span>, <span class="ruby-ivar">@app</span>)
44:                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'message'</span>] = <span class="ruby-value str">&quot;We have resent you a mail.&quot;</span>
45:                 <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;info&quot;</span>
46: 
47:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000080" class="method-detail">
        <a name="M000080"></a>

        <div class="method-heading">
          <a href="#M000080" class="method-signature">
          <span class="method-name">resendsignup</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000080-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000080-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 192</span>
192:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resendsignup</span>
193:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>].<span class="ruby-identifier">nil?</span>
194:                         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>]
195:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:email</span>].<span class="ruby-identifier">empty?</span>
196:                         <span class="ruby-ivar">@email</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:email</span>]
197:                 <span class="ruby-keyword kw">else</span>
198:                         <span class="ruby-ivar">@email</span> = <span class="ruby-keyword kw">nil</span>
199:                 <span class="ruby-keyword kw">end</span>
200: 
201:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@email</span>.<span class="ruby-identifier">nil?</span>
202:                         <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;email = ? and validkey != 'NULL' and confirmed=0&quot;</span>,<span class="ruby-ivar">@email</span>])
203:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">nil?</span>
204:                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'warning'</span>] = <span class="ruby-value str">&quot;There is no account pending with this email! &quot;</span>
205:                                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'warning'</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Either your account has been confirmed, either you need to make a new one&quot;</span>
206:                         <span class="ruby-keyword kw">else</span>
207:                                 <span class="ruby-constant">Notification</span>.<span class="ruby-identifier">deliver_signup</span>(<span class="ruby-identifier">user</span>,<span class="ruby-ivar">@app</span>)
208:                                 <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>] = { <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">email</span>, <span class="ruby-identifier">:expires</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span> }
209:                                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'message'</span>] = <span class="ruby-node">&quot;We have sent a message to #{user.email}. &quot;</span>
210:                                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'message'</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Please paste the validation key it includes.&quot;</span>
211:                                 <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;confirm&quot;</span>
212:                         <span class="ruby-keyword kw">end</span>
213:                 <span class="ruby-keyword kw">end</span>
214:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000085" class="method-detail">
        <a name="M000085"></a>

        <div class="method-heading">
          <a href="#M000085" class="method-signature">
          <span class="method-name">reset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000085-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000085-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 362</span>
362:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>
363:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>].<span class="ruby-identifier">nil?</span>
364:                         <span class="ruby-ivar">@login</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:login</span>]
365:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:login</span>].<span class="ruby-identifier">nil?</span>
366:                         <span class="ruby-ivar">@login</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:login</span>]
367:                 <span class="ruby-keyword kw">else</span>
368:                         <span class="ruby-ivar">@login</span> = <span class="ruby-value str">&quot;&quot;</span>
369:                 <span class="ruby-keyword kw">end</span>
370: 
371:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>].<span class="ruby-identifier">nil?</span>
372:                         <span class="ruby-ivar">@validkey</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:validkey</span>]
373:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:validkey</span>].<span class="ruby-identifier">nil?</span>
374:                         <span class="ruby-ivar">@validkey</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:validkey</span>]
375:                 <span class="ruby-keyword kw">else</span>
376:                         <span class="ruby-ivar">@validkey</span> = <span class="ruby-value str">&quot;&quot;</span>
377:                 <span class="ruby-keyword kw">end</span>
378: 
379:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">nil?</span>
380:                         <span class="ruby-ivar">@login</span>,<span class="ruby-ivar">@validkey</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>,<span class="ruby-value">2</span>)
381:                 <span class="ruby-keyword kw">end</span>
382:                 
383:                 <span class="ruby-comment cmt"># If validation key is wrong, we leave right now</span>
384:                 <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_first</span>([<span class="ruby-value str">&quot;login = ?&quot;</span>,<span class="ruby-ivar">@login</span>])
385:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@validkey</span>
386:                         <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'notice'</span>]  = <span class="ruby-value str">&quot;Your validation key is incorrect, please reask for your password.&quot;</span>
387:                         <span class="ruby-identifier">redirect_back_or_default</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;lostpassword&quot;</span>
388:                 <span class="ruby-keyword kw">end</span>
389:                 
390:                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span>
391:                         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:passwordconf</span>]
392:                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-value str">&quot;Your passwords don't match!&quot;</span>
393:                         <span class="ruby-keyword kw">else</span>
394:                                 <span class="ruby-comment cmt"># Dont need this verification, but who knows... :]</span>
395:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@validkey</span>
396:                                         <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password</span> = <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>]
397:                                         <span class="ruby-identifier">user</span>.<span class="ruby-identifier">confirmed</span> = <span class="ruby-value">1</span> <span class="ruby-comment cmt"># Just in case...</span>
398:                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">save</span>
399:                                                 <span class="ruby-identifier">user</span>.<span class="ruby-identifier">validkey</span> = <span class="ruby-keyword kw">nil</span>
400:                                                 <span class="ruby-identifier">user</span>.<span class="ruby-identifier">save</span>
401:                                                 <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:email</span>] = <span class="ruby-keyword kw">nil</span>
402:                                                 <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span> <span class="ruby-identifier">user</span>
403:                                                 <span class="ruby-identifier">flash</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-value str">&quot;Your password has been changed.&quot;</span>
404:                                                 <span class="ruby-identifier">redirect_back_or_default</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;welcome&quot;</span>
405:                                         <span class="ruby-keyword kw">else</span>
406:                                                 <span class="ruby-comment cmt"># There is a problem, we give the view access to this informations</span>
407:                                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'notice'</span>] = <span class="ruby-value str">&quot;There were an error while saving your new password.&quot;</span>
408:                                                 <span class="ruby-ivar">@newuser</span> = <span class="ruby-identifier">user</span>
409:                                         <span class="ruby-keyword kw">end</span>
410:                                 <span class="ruby-keyword kw">end</span>
411:                         <span class="ruby-keyword kw">end</span>
412:                 <span class="ruby-keyword kw">end</span>
413:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000081" class="method-detail">
        <a name="M000081"></a>

        <div class="method-heading">
          <a href="#M000081" class="method-signature">
          <span class="method-name">signup</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000081-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000081-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 216</span>
216:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">signup</span>
217:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@app</span>[<span class="ruby-identifier">:allow_self_registration</span>]
218:                         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Account creation is disabled.&quot;</span>
219:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;login&quot;</span>
220:                 <span class="ruby-keyword kw">end</span>
221: 
222:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post?</span>
223:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">false</span> <span class="ruby-comment cmt">#@params[:terms] != 9</span>
224:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:warning</span>] = <span class="ruby-value str">&quot;You need to accept terms and conditions to create an account.&quot;</span>
225:       <span class="ruby-keyword kw">else</span>
226:                         <span class="ruby-ivar">@newuser</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>])
227:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">confirmed</span>= <span class="ruby-value">1</span>
228:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">ipaddr</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">remote_ip</span>
229:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">domains</span> = { <span class="ruby-value str">'USERS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
230:                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">password</span>=<span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:post</span>][<span class="ruby-identifier">:password</span>]
231: 
232:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">save</span>
233:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
234:                                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">domains</span> = { <span class="ruby-value str">'USERS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-value str">'ADMIN'</span>=<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
235:                                         <span class="ruby-ivar">@newuser</span>.<span class="ruby-identifier">save</span>
236:                                 <span class="ruby-keyword kw">end</span>  
237:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">saveSession</span> <span class="ruby-ivar">@newuser</span>
238:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;manage&quot;</span>
239:                                 <span class="ruby-comment cmt">#Notification.deliver_signup(@newuser, @app)</span>
240:                                 <span class="ruby-comment cmt">#cookies[:email] = { :value =&gt; @newuser.email, :expires =&gt; nil }</span>
241:           <span class="ruby-comment cmt">#flash['message'] = &quot;We have sent a message to #{@newuser.email}. &quot;</span>
242:                                 <span class="ruby-comment cmt">#flash['message'] &lt;&lt; &quot;Please paste the validation key it includes.&quot;</span>
243:           <span class="ruby-comment cmt">#redirect_to :action =&gt; &quot;confirm&quot;</span>
244:         <span class="ruby-keyword kw">else</span>
245:           <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'warning'</span>]  = <span class="ruby-value str">&quot;An error occured while creating this account.&quot;</span>
246:         <span class="ruby-keyword kw">end</span>
247:       <span class="ruby-keyword kw">end</span>
248:                 <span class="ruby-keyword kw">else</span>
249:                         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">ident</span>
250:                                 <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-value str">'message'</span>]  = <span class="ruby-value str">&quot;You already have an account and are authentified. Are you sure you want to create a new account ?&quot;</span>
251:                         <span class="ruby-keyword kw">end</span>
252:     <span class="ruby-keyword kw">end</span>      
253:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000086" class="method-detail">
        <a name="M000086"></a>

        <div class="method-heading">
          <a href="#M000086" class="method-signature">
          <span class="method-name">welcome</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000086-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000086-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 415</span>
415:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">welcome</span>
416:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">
          <a href="#M000089" class="method-signature">
          <span class="method-name">cancelSession</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000089-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000089-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 445</span>
445:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cancelSession</span>
446:                 <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:user</span>] = <span class="ruby-keyword kw">nil</span>
447:                 <span class="ruby-ivar">@user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
448:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">
          <a href="#M000088" class="method-signature">
          <span class="method-name">saveSession</span><span class="method-args">(user, keepalive=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000088-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000088-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 424</span>
424:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">saveSession</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">keepalive</span>=<span class="ruby-keyword kw">nil</span>)
425:                 <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">keepalive</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">keepalive</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
426:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">keepalive</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
427:                                 <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:user</span>] = { 
428:                                         <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">sessionstring</span>(<span class="ruby-value">60</span>.<span class="ruby-identifier">days</span>.<span class="ruby-identifier">from_now</span>),
429:                                         <span class="ruby-identifier">:expires</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">60</span>.<span class="ruby-identifier">days</span>.<span class="ruby-identifier">from_now</span> 
430:                                 }
431:                         <span class="ruby-keyword kw">else</span>
432:                                 <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:user</span>] = { 
433:                                         <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">sessionstring</span>(<span class="ruby-value">60</span>.<span class="ruby-identifier">days</span>.<span class="ruby-identifier">from_now</span>),
434:                                         <span class="ruby-identifier">:expires</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">keepalive</span>)
435:                                 }
436:                         <span class="ruby-keyword kw">end</span>
437:                 <span class="ruby-keyword kw">else</span>
438:                         <span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">:user</span>] = { 
439:                                 <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">sessionstring</span>,
440:                                 <span class="ruby-identifier">:expires</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>
441:                         }
442:                 <span class="ruby-keyword kw">end</span>
443:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">
          <a href="#M000091" class="method-signature">
          <span class="method-name">theme_layout</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000091-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000091-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 455</span>
455:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">theme_layout</span>
456:                 <span class="ruby-node">&quot;../auth/theme/#{@app[:theme]}/layout.rhtml&quot;</span>
457:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">
          <a href="#M000090" class="method-signature">
          <span class="method-name">this_auth</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000090-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000090-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/auth_controller.rb, line 450</span>
450:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">this_auth</span>
451:                 <span class="ruby-ivar">@app</span>
452:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>